const snapshot = [
  {
    id: '2523833',
    seller: '1',
    sellerChain: [
      '1',
      'ceamrb'
    ],
    slas: [
      {
        id: 'Retirada na Loja (MRB)',
        deliveryChannel: 'pickup-in-point',
        name: 'Retirada na Loja (MRB)',
        deliveryIds: [
          {
            courierId: '1',
            warehouseId: '1_2',
            dockId: '1',
            courierName: 'Entrega Flexível',
            quantity: 1,
            kitItemDetails: []
          }
        ],
        shippingEstimate: '1bd',
        shippingEstimateDate: null,
        lockTTL: null,
        availableDeliveryWindows: [],
        deliveryWindow: null,
        price: 0,
        listPrice: 0,
        tax: 0,
        pickupStoreInfo: {
          isPickupStore: true,
          friendlyName: 'C&A Shopping Morumbi - Drive Thru',
          address: {
            addressType: 'pickup',
            receiverName: null,
            addressId: 'MRB',
            isDisposable: true,
            postalCode: '04707000',
            city: 'São Paulo',
            state: 'SP',
            country: 'BRA',
            street: 'Av. Roque Petroni Júnior',
            number: '1089',
            neighborhood: 'Morumbi',
            complement: 'Loja CeA Loja 1 - MRB 140',
            reference: null,
            geoCoordinates: [
              -46.698512,
              -23.622331
            ]
          },
          additionalInfo: '{"phoneNumber":"(11) 2167-0040","pickupInstructions":"Apresentar documento com foto e dirigir-se a àrea de celulares e tablets"}',
          dockId: null
        },
        pickupPointId: 'ceamrb_MRB',
        pickupDistance: 5.20493221282959,
        polygonName: null,
        transitTime: '1bd'
      }
    ],
    price: 1799,
    listPrice: 1999
  },
  {
    id: '2523834',
    seller: '1',
    sellerChain: [
      '1'
    ],
    slas: [],
    price: 21999,
    listPrice: 21999
  },
  {
    id: '2523835',
    seller: '1',
    sellerChain: [
      '1',
      'ceasts'
    ],
    slas: [
      {
        id: 'Normal',
        deliveryChannel: 'delivery',
        name: 'Normal',
        deliveryIds: [
          {
            courierId: 'ASTROLOG_NORMAL',
            warehouseId: '1_2',
            dockId: 'SFS_STS',
            courierName: ' ASTROLOG_NORMAL',
            quantity: 1,
            kitItemDetails: []
          }
        ],
        shippingEstimate: '5bd',
        shippingEstimateDate: null,
        lockTTL: null,
        availableDeliveryWindows: [],
        deliveryWindow: null,
        price: 358,
        listPrice: 358,
        tax: 0,
        pickupStoreInfo: {
          isPickupStore: false,
          friendlyName: null,
          address: null,
          additionalInfo: null,
          dockId: null
        },
        pickupPointId: null,
        pickupDistance: null,
        polygonName: null,
        transitTime: '2bd'
      }
    ],
    price: 1799,
    listPrice: 1999
  },
  {
    id: '2523836',
    seller: '1',
    sellerChain: [
      '1',
      'ceasts'
    ],
    slas: [
      {
        id: 'Normal',
        deliveryChannel: 'delivery',
        name: 'Normal',
        deliveryIds: [
          {
            courierId: 'ASTROLOG_NORMAL',
            warehouseId: '1_2',
            dockId: 'SFS_STS',
            courierName: ' ASTROLOG_NORMAL',
            quantity: 1,
            kitItemDetails: []
          }
        ],
        shippingEstimate: '5bd',
        shippingEstimateDate: null,
        lockTTL: null,
        availableDeliveryWindows: [],
        deliveryWindow: null,
        price: 358,
        listPrice: 358,
        tax: 0,
        pickupStoreInfo: {
          isPickupStore: false,
          friendlyName: null,
          address: null,
          additionalInfo: null,
          dockId: null
        },
        pickupPointId: null,
        pickupDistance: null,
        polygonName: null,
        transitTime: '2bd'
      }
    ],
    price: 1799,
    listPrice: 1999
  },
  {
    id: '2523837',
    seller: '1',
    sellerChain: [
      '1',
      'ceasts'
    ],
    slas: [
      {
        id: 'Normal',
        deliveryChannel: 'delivery',
        name: 'Normal',
        deliveryIds: [
          {
            courierId: 'ASTROLOG_NORMAL',
            warehouseId: '1_2',
            dockId: 'SFS_STS',
            courierName: ' ASTROLOG_NORMAL',
            quantity: 1,
            kitItemDetails: []
          }
        ],
        shippingEstimate: '5bd',
        shippingEstimateDate: null,
        lockTTL: null,
        availableDeliveryWindows: [],
        deliveryWindow: null,
        price: 358,
        listPrice: 358,
        tax: 0,
        pickupStoreInfo: {
          isPickupStore: false,
          friendlyName: null,
          address: null,
          additionalInfo: null,
          dockId: null
        },
        pickupPointId: null,
        pickupDistance: null,
        polygonName: null,
        transitTime: '2bd'
      }
    ],
    price: 1799,
    listPrice: 1999
  },
  {
    id: '2523834',
    seller: '1',
    sellerChain: [
      '1',
      'ceasts'
    ],
    slas: [
      {
        id: 'Normal',
        deliveryChannel: 'delivery',
        name: 'Normal',
        deliveryIds: [
          {
            courierId: 'ASTROLOG_NORMAL',
            warehouseId: '1_2',
            dockId: 'SFS_STS',
            courierName: ' ASTROLOG_NORMAL',
            quantity: 1,
            kitItemDetails: []
          }
        ],
        shippingEstimate: '5bd',
        shippingEstimateDate: null,
        lockTTL: null,
        availableDeliveryWindows: [],
        deliveryWindow: null,
        price: 358,
        listPrice: 358,
        tax: 0,
        pickupStoreInfo: {
          isPickupStore: false,
          friendlyName: null,
          address: null,
          additionalInfo: null,
          dockId: null
        },
        pickupPointId: null,
        pickupDistance: null,
        polygonName: null,
        transitTime: '2bd'
      }
    ],
    price: 1799,
    listPrice: 1999
  },
  {
    id: '2523834',
    seller: '1',
    sellerChain: [
      '1',
      'ceasts'
    ],
    slas: [
      {
        id: 'Normal',
        deliveryChannel: 'delivery',
        name: 'Normal',
        deliveryIds: [
          {
            courierId: 'ASTROLOG_NORMAL',
            warehouseId: '1_2',
            dockId: 'SFS_STS',
            courierName: ' ASTROLOG_NORMAL',
            quantity: 1,
            kitItemDetails: []
          }
        ],
        shippingEstimate: '5bd',
        shippingEstimateDate: null,
        lockTTL: null,
        availableDeliveryWindows: [],
        deliveryWindow: null,
        price: 358,
        listPrice: 358,
        tax: 0,
        pickupStoreInfo: {
          isPickupStore: false,
          friendlyName: null,
          address: null,
          additionalInfo: null,
          dockId: null
        },
        pickupPointId: null,
        pickupDistance: null,
        polygonName: null,
        transitTime: '2bd'
      }
    ],
    price: 1799,
    listPrice: 1999
  }
]

export default (region, items) =>
  new Promise((resolve) => {

    if ('vtexjs' in window) {
      const cep = region.localizacao.cep

      vtexjs.checkout.simulateShipping(items, cep, 'BRA')
        .done((result) => {
          const itemConditions = result.purchaseConditions.itemPurchaseConditions
          // const disponiveis = f.filter(snapshot, (item) => f.not(f.isEmpty(f.prop('slas', item))))
          // const slas = f.flatten(f.map(snapshot, f.prop('slas')))

          resolve(
            itemConditions
          )
        })
    }else{
      resolve(
        snapshot
      )      
    }
  })
